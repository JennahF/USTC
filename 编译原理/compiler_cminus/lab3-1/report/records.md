# 团队工作记录

记录团队的学习过程和讨论过程，

## 学习过程

描述队长如何安排成员进行学习工作，并描述完成情况

## 讨论

时间：

​	11月19日 19:00-23:00

​	11月21日 19:00-23:00

​	11月22日 19:00-23:00

​	11月23日  8:00-23:30

​	11月24日  8:00-21:00	

地点：

​	3A教学楼、图书馆研讨室

参与者：

​	孙书情、王晶、范睿

主题：
	如何分配三人各自任务、各自遇到了什么问题、跑测试文件时有什么bug

![讨论截图](figs/%E8%AE%A8%E8%AE%BA%E6%88%AA%E5%9B%BE.png)

上面这个截图是我们第一次讨论时的结果。我们先大概思考了一遍每个函数的实验思路，然后根据工作量平均分配各自的任务量，以三种不同颜色标出。我们还以蓝色字体写出了需要保存值的函数，以约定使用同一变量（但实际上我们并没有用这么多变量，而是把所有需要保存值的表达式均保存在同一变量下，这是后来我们才更改的）。

21-24号的讨论其实是大家坐在一起写代码，有什么问题可以立即提出然后解决。

### 过程描述

#### 11.19

如上所述，我们这一天分配了各自的任务，约定了共同使用的变量，然后各自先去写第一版代码。

#### 11.21

这天的讨论只是11.19日讨论的延伸，我们并没有写完全部的代码。我们只是交流了一下出现问题的函数应该怎样进行，不过对于代码的结构上有了更深的思考。

#### 11.22

这天的讨论结束后，我们将所有函数的代码都写好了，然后整合到了一起。此时只是没有语法错误，但是跑不起来。在这天的讨论中，我们主要攻克了fun_declaration的写法。并且学会了使用Type::getInt32Ty()和Type::getInt32PtrTy()。这两个函数可以生成不同类型。当我们用他们去分配空间时，可以得到不同类型的变量（即int和int*）。我们有这两个函数初始化了函数声明中存放参数的向量，并用该向量生成了不同参数类型和个数的函数，收获颇丰。

#### 11.23

这天我们主要攻克了变量的数组、函数调用等问题，解决了数组传参的问题。做到了可以定义局部数组、全局数组、向函数中传递数组变量的工作。同时我们也开始了测试工作。测试了函数声明，控制流语句等。这天的讨论结束时，我们（差一点点就）跑成了gcd.cminus测试样例。

#### 11.24

这天我们开始了最后debug工作。我们首先发现当向数组中传递数组变量时无法在函数中访问和改变数组的值。然后我们参考clang生成的.ll文件，学会了使用zext等命令。通过思考，我们认为作为参数的数组和作为局部/全局变量的数组在使用时有所区别，于是我们建立了一个向量保存所有的数组参数的名字，解决了这个问题。我们还重写了控制流函数，增强了控制流函数的鲁棒性。到这里我们的所以代码已经写的差不多了。于是我们写了很多千奇百怪的测试文件，一个个进行测试，找出了（许多）bug，一一解决。最后我们解决了比较结果无法赋值的情况，通过zext和trunc命令，我们顺利地解决了问题。


### 结论

本次实验理解起来难、工作量大，还需要学习很多新东西（c++），我们通过合理的工作分配，及时的讨论交流，将这些困难一一克服。通过更新debug手段，我们找到了高效准确的debug方式，当看不出来bug在哪里时，我们将困难拆解成小块，一一检查小块的正确性，有效地发现并解决了困难。当自己写的代码将奇怪的测试样例一一跑通时，我们感到非常快乐与感动。虽然这是一个十分困难的lab，但是我们用自己的力量完成了它，并给出了非常好的结果。